import{p as Z,aE as te,a7 as L,am as le,ag as se,aU as oe,aV as ne,ae as re,a9 as ue,aa as de,g as q,ab as ie,ai as ce,t as ve,aW as fe,an as me,ak as pe,aX as Ve,aY as ge,aj as be,e as J,f as e,aZ as he,a_ as ye,r as v,a$ as Ce,j as _e,c as ke,o as T,l as R,n as X,q as D,v as E,x as a,y as Se,z as Pe,F as U,A as h,N as C,B as N,C as $,D as Ae,_ as Te,E as x,G as w,H as O,I as j,J as xe,b0 as z,ap as De,K as Ie,L as Fe,M as Be,O as Re,Q as A,P as K,T as Ee,U as Ue}from"./assets/axios-CXuHkYsP.js";import{V as M}from"./assets/VSpacer-B6XjHHdU.js";const Ne=Z({color:String,...te(),...L(),...le(),...se(),...oe(),...ne(),...re(),...ue(),...de()},"VSheet"),$e=q()({name:"VSheet",props:Ne(),setup(s,f){let{slots:m}=f;const{themeClasses:_}=ie(s),{backgroundColorClasses:p,backgroundColorStyles:V}=ce(ve(s,"color")),{borderClasses:c}=fe(s),{dimensionStyles:u}=me(s),{elevationClasses:i}=pe(s),{locationStyles:r}=Ve(s),{positionClasses:n}=ge(s),{roundedClasses:g}=be(s);return J(()=>e(s.tag,{class:["v-sheet",_.value,p.value,c.value,i.value,n.value,g.value,s.class],style:[V.value,u.value,r.value,s.style]},m)),{}}}),we=Z({...L(),...he()},"VForm"),Oe=q()({name:"VForm",props:we(),emits:{"update:modelValue":s=>!0,submit:s=>!0},setup(s,f){let{slots:m,emit:_}=f;const p=ye(s),V=v();function c(i){i.preventDefault(),p.reset()}function u(i){const r=i,n=p.validate();r.then=n.then.bind(n),r.catch=n.catch.bind(n),r.finally=n.finally.bind(n),_("submit",r),r.defaultPrevented||n.then(g=>{var k;let{valid:y}=g;y&&((k=V.value)==null||k.submit())}),r.preventDefault()}return J(()=>{var i;return e("form",{ref:V,class:["v-form",s.class],style:s.style,novalidate:!0,onReset:c,onSubmit:u},[(i=m.default)==null?void 0:i.call(m,p)])}),Ce(p,V)}}),je={id:"start-page"},ze=X("h5",null,"Data provider ",-1),Ke={__name:"settingsApp",props:["providerSet","providers","user","csrf"],setup(s){const f=_e(),m=s,_=JSON.parse(m.providerSet.replace(/'/g,'"')),p=JSON.parse(m.providers.replace(/'/g,'"')),V=v(p),c=v(!1),u=v(_),i=v(null),r=v(!1),n=v(!1),g=v(""),y=v(""),k=v(!1),I=m.csrf,H=ke(()=>u.value.length<2);let F=0;function W(){const o={id:"t-"+F,host:"",API_Key:"",provider:V.value[0]};u.value.push(o),F++}function Y(o){if(o.startsWith("t-"))u.value=u.value.filter(l=>l.id!==o),g.value="The item has been removed successfully.",r.value=!0,n.value=!1,A(()=>{f("#start-page",{offset:0})});else{const l={data:o};K.post("/removeSettings/",l,{headers:{"X-CSRFToken":I,"Content-Type":"application/json"}}).then(function(b){b.data.deleted==="True"?(u.value=u.value.filter(P=>P.id!==o),g.value="The item has been removed successfully.",r.value=!0,n.value=!1,A(()=>{f("#start-page",{offset:0})})):(y.value="The item could not be removed due to an error.",n.value=!0,r.value=!1,A(()=>{f("#start-page",{offset:0})}))}).catch(b=>{y.value="The item could not be removed due to an error.",n.value=!0})}}function Q(o){i.value=o,c.value=!0}function ee(){const o={data:i.value};K.post("/saveSettings/",o,{headers:{"X-CSRFToken":I,"Content-Type":"application/json"}}).then(function(l){n.value=!1,r.value=!0,g.value="The settings have been saved successfully.";const b=l.data.saveReg,t=u.value.findIndex(P=>P.id===i.value.id);t!==-1&&(u.value[t]={...u.value[t],...b}),A(()=>{f("#start-page",{offset:0})})}).catch(l=>{y.value="The settings could not be saved due to an error.",n.value=!0,r.value=!1,A(()=>{f("#start-page",{offset:0})})}),c.value=!1}function ae(o){return B.every(b=>b(o.host)===!0)}function S(o){return o.provider==="OMERO"}const B=[o=>o?!0:"You must enter a host",o=>/^(https?:\/\/)?((([a-zA-Z0-9]([a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z]{2,})|localhost)(:\d{1,5})?(\/.*)?$/.test(o)?!0:"Please include a valid host"];return(o,l)=>{const b=Te;return T(),R(U,null,[X("div",je,[e(D,{modelValue:r.value,"onUpdate:modelValue":l[0]||(l[0]=t=>r.value=t),text:g.value,type:"success",density:"compact",closable:""},null,8,["modelValue","text"]),e(D,{modelValue:n.value,"onUpdate:modelValue":l[1]||(l[1]=t=>n.value=t),text:y.value,type:"error",variant:"tonal",border:"top",density:"compact",closable:""},null,8,["modelValue","text"]),H.value?(T(),E(D,{key:0,type:"warning",density:"compact",closable:""},{default:a(()=>[h(" In addition to OMERO you need to add a second data provider, please add it and configure it correctly. ")]),_:1})):Se("",!0)]),e(Pe,null,{default:a(()=>[e($e,{class:"d-flex align-end flex-column"},{default:a(()=>[e(C,{color:"teal","prepend-icon":"$mdiPlusCircle",onClick:W,class:"ma-2 pa-2"},{default:a(()=>[h("Add")]),_:1})]),_:1}),e(N,null,{default:a(()=>[e($,{justify:"center"},{default:a(()=>[(T(!0),R(U,null,Ae(u.value,(t,P)=>(T(),E(x,{md:"4",key:P,cols:"auto"},{default:a(()=>[e(w,null,{default:a(()=>[e(O,{color:"#0377a1",flat:""},{default:a(()=>[e(j,null,{default:a(()=>[ze]),_:1}),e(C,{class:"ma-2",onClick:d=>Y(t.id),disabled:S(t),variant:"tonal",icon:"$mdiDelete"},null,8,["onClick","disabled"])]),_:2},1024),e(xe,null,{default:a(()=>[e(Oe,{ref_for:!0,ref:"formRef",modelValue:k.value,"onUpdate:modelValue":l[2]||(l[2]=d=>k.value=d),"lazy-validation":""},{default:a(()=>[e(N,null,{default:a(()=>[e($,null,{default:a(()=>[e(x,{cols:"12"},{default:a(()=>[e(z,{label:"Host",variant:"outlined",modelValue:t.host,"onUpdate:modelValue":d=>t.host=d,rules:B,required:"",disabled:S(t)},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1024),e(x,{cols:"12"},{default:a(()=>[e(z,{label:"API Key",modelValue:t.API_Key,"onUpdate:modelValue":d=>t.API_Key=d,variant:"outlined",disabled:S(t)},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1024),e(x,{cols:"12"},{default:a(()=>[e(De,{label:"provider",items:V.value,modelValue:t.provider,"onUpdate:modelValue":d=>t.provider=d,variant:"outlined","hide-details":"",required:"",disabled:S(t)},null,8,["items","modelValue","onUpdate:modelValue","disabled"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])]),_:2},1024),e(Ie),e(Fe,null,{default:a(()=>[e(M),e(C,{color:"teal",disabled:!ae(t)||S(t),onClick:d=>Q(t),variant:"flat"},{default:a(()=>[h("Save Changes")]),_:2},1032,["disabled","onClick"]),e(Be,{modelValue:c.value,"onUpdate:modelValue":l[5]||(l[5]=d=>c.value=d),"max-width":"400",persistent:""},{default:a(()=>[e(w,null,{actions:a(()=>[e(M),e(C,{color:"red-darken-4",onClick:l[4]||(l[4]=d=>c.value=!1),variant:"flat"},{default:a(()=>[h("Cancel")]),_:1}),e(C,{color:"teal",onClick:ee,variant:"flat"},{default:a(()=>[h("Accept")]),_:1})]),default:a(()=>[e(O,{color:"#0377a1",flat:""},{append:a(()=>[e(C,{icon:"$close",variant:"text",onClick:l[3]||(l[3]=d=>c.value=!1)})]),default:a(()=>[e(j,null,{default:a(()=>[h("Save Changes")]),_:1})]),_:1}),e(Re,null,{default:a(()=>[h("Do you want to save the changes?")]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e(b)]),_:1})],64)}}},Me=document.getElementById("providerSet").getAttribute("value")||"{}",Ze=document.getElementById("providers").getAttribute("value")||"{}",Le=document.getElementById("user").getAttribute("value")||"{}",qe=document.getElementsByName("csrfmiddlewaretoken")[0].getAttribute("value")||"",G=Ee(Ke,{providerSet:Me,providers:Ze,user:Le,csrf:qe});Ue(G);G.mount("#app");
